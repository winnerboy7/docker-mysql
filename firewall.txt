sudo apt update
sudo apt install iptables-persistent

# Set default input policy to DROP (only after adding ACCEPT rules)
sudo iptables -P INPUT DROP
# Allow all output traffic
sudo iptables -P OUTPUT ACCEPT
# Allow loopback traffic
sudo iptables -A INPUT -i lo -j ACCEPT
sudo iptables -A OUTPUT -o lo -j ACCEPT
# Allow established and related connections
sudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
# Allow incoming SSH (port 22)
sudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT
# Allow incoming HTTP (port 80)
sudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT
# Allow incoming HTTPS (port 443)
sudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT
# Save IPv4 rules
sudo netfilter-persistent save
# To check saved IPv4 rules
cat /etc/iptables/rules.v4
